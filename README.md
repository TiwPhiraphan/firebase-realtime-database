
# ðŸ”¥firebase-realtime-database

A simple, typesafe wrapper for Firebase Realtime Database with built-in schema validation using [Zod](https://github.com/colinhacks/zod).  
Supports both single-key collections (like config) and tables with autogenerated UUID keys.

firebase-realtime-database

## Features

- Typed access with Zod schema validation
- Easy CRUD operations for collections and tables
- UUID generation for new table entries
- Supports updating with callbacks for safe modification
- Compatible with Firebase Admin SDK Realtime Database

firebase-realtime-database

## Usage

```ts
import { FirebaseApp, zod as z } from "firebase-realtime-database";

const firebaseApp = new FirebaseApp({
  database: "https://your-project.firebaseio.com",
  credential: {
    projectId: "your-project-id",
    privateKey: "your-private-key",
    clientEmail: "your-client-email",
  }
});

// Define schema for config collection
const configSchema = {
  siteName: z.string(),
  maxUsers: z.number().int(),
  maintenanceMode: z.boolean(),
};

// Create a collection instance for "config"
const config = firebaseApp.collection("config", configSchema);

async function example() {
  // Set config data (overwrites)
  await config.set({
    siteName: "My Site",
    maxUsers: 1000,
    maintenanceMode: false,
  });

  // Get config data
  const currentConfig = await config.get();
  console.log(currentConfig);

  // Update config safely
  await config.update((legacy) => {
    if (legacy) {
      return {
        ...legacy,
        maintenanceMode: true,
      };
    }
    return legacy;
  });
}
```

firebase-realtime-database

## Table Usage (with auto-generated IDs)

```ts
const messageSchema = {
  text: z.string(),
  createdAt: z.string(),
  senderId: z.string(),
};

const messages = firebaseApp.table("messages", messageSchema);

async function tableExample() {
  // Create a new message with generated ID
  const newId = await messages.create({
    text: "Hello World",
    createdAt: new Date().toISOString(),
    senderId: "user1",
  });
  console.log("New message ID:", newId);

  // Find message by ID
  const message = await messages.findById(newId);
  console.log(message);

  // Update message by ID
  await messages.transitionById(newId, (legacy) => {
    if (legacy) {
      return { ...legacy, text: "Updated text" };
    }
  });

  // Delete message by ID
  await messages.deleteById(newId);
}
```

firebase-realtime-database

## Example Database Structure

### Collection: `config`

```json
{
  "config": {
    "siteName": "My Site",
    "maxUsers": 1000,
    "maintenanceMode": false
  }
}
```

### Table: `messages`

```json
{
  "messages": {
    "a1b2c3d4-e5f6-7g8h-9i0j-k1l2m3n4o5p6": {
      "text": "Hello World",
      "createdAt": "2025-07-26T15:00:00Z",
      "senderId": "user1"
    },
    "z9y8x7w6-v5u4-t3s2-r1q0-p9o8n7m6l5k4": {
      "text": "Another message",
      "createdAt": "2025-07-26T15:05:00Z",
      "senderId": "user2"
    }
  }
}
```

firebase-realtime-database

## API Reference

### `FirebaseApp`

- `collection(name, schema)` - Create a collection interface for fixed keys (e.g. config)
- `table(name, schema)` - Create a table interface for dynamic entries with UUID keys

### `FirebaseCollection`

- `get()` - Get all data from the collection
- `set(value)` - Set entire collection data
- `update(callback)` - Update data with callback function
- `delete()` - Delete entire collection

### `FirebaseTable`

- `create(value)` - Add new entry with generated UUID
- `findAll()` - Get all entries with `_id` keys
- `findById(id)` - Get entry by ID
- `findByChild(key, value)` - Get first entry matching a child key/value
- `filterByChild(key, value)` - Get all entries matching child key/value
- `transitionByChild(key, value, updateFunc)` - Update first matching entry by child key/value
- `transitionById(id, updateFunc)` - Update entry by ID
- `deleteById(id)` - Delete entry by ID

firebase-realtime-database

## License

MIT License

firebase-realtime-database

Thank you for using **firebase-realtime-database**!  
If you have questions or contributions, feel free to open an issue or PR.
